{"version":3,"sources":["webentry.js"],"names":["define","arrays","Deferred","filer","webentry","one","entry","path","d","onError","e","reject","isFile","file","relativePath","resolve","isDirectory","createReader","readEntries","entries","all","name","then","files","catch","promise","map","concat","apply","arguments"],"mappings":";;;;;;;AAACA,QACG,uBACA,yBACA,WACF,SAASC,EAAOC,EAAUC,GACzB,IAAIC,EAAW,WACV,SAASC,EAAIC,EAAOC,GAChB,IAAIC,EAAI,IAAIN,EACRO,EAAU,SAASC,GACfF,EAAEG,OAAOD,IAIjB,GADAH,EAAOA,GAAQ,GACXD,EAAMM,OACNN,EAAMO,KAAK,SAASA,GAChBA,EAAKC,aAAeP,EACpBC,EAAEO,QAAQF,IACXJ,QACA,GAAIH,EAAMU,YAAa,CACVV,EAAMW,eACZC,YAAY,SAASC,GAC3BC,EACID,EACAZ,EAAOD,EAAMe,KAAO,KACtBC,KAAK,SAASC,GACZf,EAAEO,QAAQQ,KACXC,MAAMf,IACVA,QAIHD,EAAEO,YAEN,OAAOP,EAAEiB,QAGb,SAASL,EAAID,EAASZ,GAClB,OAAOL,EAASkB,IACZnB,EAAOyB,IAAIP,EAAS,SAASb,GACzB,OAAOD,EAAIC,EAAOC,MAExBe,KAAK,WACH,OAAOK,OAAOC,SAAUC,aAIhC,OACIxB,IAAKA,EACLe,IAAKA,GA3CC,GA+Cd,OAAOjB,EAAMC,SAAWA","file":"../webentry.js","sourcesContent":[" define([\r\n    \"skylark-langx/arrays\",\r\n    \"skylark-langx/Deferred\",\r\n    \"./filer\"\r\n],function(arrays,Deferred, filer){\r\n   var webentry = (function() {\r\n        function one(entry, path) {\r\n            var d = new Deferred(),\r\n                onError = function(e) {\r\n                    d.reject(e);\r\n                };\r\n\r\n            path = path || '';\r\n            if (entry.isFile) {\r\n                entry.file(function(file) {\r\n                    file.relativePath = path;\r\n                    d.resolve(file);\r\n                }, onError);\r\n            } else if (entry.isDirectory) {\r\n                var dirReader = entry.createReader();\r\n                dirReader.readEntries(function(entries) {\r\n                    all(\r\n                        entries,\r\n                        path + entry.name + '/'\r\n                    ).then(function(files) {\r\n                        d.resolve(files);\r\n                    }).catch(onError);\r\n                }, onError);\r\n            } else {\r\n                // Return an empy list for file system items\r\n                // other than files or directories:\r\n                d.resolve([]);\r\n            }\r\n            return d.promise;\r\n        }\r\n\r\n        function all(entries, path) {\r\n            return Deferred.all(\r\n                arrays.map(entries, function(entry) {\r\n                    return one(entry, path);\r\n                })\r\n            ).then(function() {\r\n                return concat.apply([], arguments);\r\n            });\r\n        }\r\n\r\n        return {\r\n            one: one,\r\n            all: all\r\n        };\r\n    })();\r\n\r\n    return filer.webentry = webentry;\r\n});"]}