{"version":3,"sources":["dropzone.js"],"names":["define","Deferred","styler","eventer","filer","webentry","dropzone","elm","params","hoverClass","droppedCallback","dropped","enterdCount","on","e","dataTransfer","types","indexOf","stop","addClass","removeClass","items","length","webkitGetAsEntry","getAsEntry","all","langx","map","item","then","files","this"],"mappings":";;;;;;;AAAEA,QACE,yBACA,2BACA,4BACA,UACA,cACF,SAASC,EAAUC,EAAQC,EAASC,EAAOC,GA4DxC,OAAOD,EAAME,SAvDd,SAAkBC,EAAKC,GAEnB,IAAIC,GADJD,EAASA,OACeC,YAAc,WAClCC,EAAkBF,EAAOG,QAEzBC,EAAc,EA+ClB,OA9CAT,EAAQU,GAAGN,EAAK,YAAa,SAASO,GAC9BA,EAAEC,cAAgBD,EAAEC,aAAaC,MAAMC,QAAQ,UAAY,IAC3Dd,EAAQe,KAAKJ,GACbF,IACAV,EAAOiB,SAASZ,EAAKE,MAI7BN,EAAQU,GAAGN,EAAK,WAAY,SAASO,GAC7BA,EAAEC,cAAgBD,EAAEC,aAAaC,MAAMC,QAAQ,UAAY,GAC3Dd,EAAQe,KAAKJ,KAIrBX,EAAQU,GAAGN,EAAK,YAAa,SAASO,GAC9BA,EAAEC,cAAgBD,EAAEC,aAAaC,MAAMC,QAAQ,UAAY,GAExC,KADnBL,GAEIV,EAAOkB,YAAYb,EAAKE,KAKpCN,EAAQU,GAAGN,EAAK,OAAQ,SAASO,GAC7B,GAAIA,EAAEC,cAAgBD,EAAEC,aAAaC,MAAMC,QAAQ,UAAY,IAC3Df,EAAOkB,YAAYb,EAAKE,GACxBN,EAAQe,KAAKJ,GACTJ,GAAiB,CACjB,IAAIW,EAAQP,EAAEC,aAAaM,MACvBA,GAASA,EAAMC,SAAWD,EAAM,GAAGE,kBAC/BF,EAAM,GAAGG,YACbnB,EAASoB,IACLC,MAAMC,IAAIN,EAAO,SAASO,GACtB,OAAIA,EAAKL,iBACEK,EAAKL,mBAETK,EAAKJ,gBAElBK,KAAKnB,GAEPA,EAAgBI,EAAEC,aAAae,UAMxCC","file":"../dropzone.js","sourcesContent":["  define([\r\n    \"skylark-langx/Deferred\",\r\n    \"skylark-utils-dom/styler\",\r\n    \"skylark-utils-dom/eventer\",\r\n    \"./filer\",\r\n    \"./webentry\"\r\n],function(Deferred, styler, eventer, filer, webentry){  /*\r\n     * Make the specified element to could accept HTML5 file drag and drop.\r\n     * @param {HTMLElement} elm\r\n     * @param {PlainObject} params\r\n     */\r\n    function dropzone(elm, params) {\r\n        params = params || {};\r\n        var hoverClass = params.hoverClass || \"dropzone\",\r\n            droppedCallback = params.dropped;\r\n\r\n        var enterdCount = 0;\r\n        eventer.on(elm, \"dragenter\", function(e) {\r\n            if (e.dataTransfer && e.dataTransfer.types.indexOf(\"Files\") > -1) {\r\n                eventer.stop(e);\r\n                enterdCount++;\r\n                styler.addClass(elm, hoverClass)\r\n            }\r\n        });\r\n\r\n        eventer.on(elm, \"dragover\", function(e) {\r\n            if (e.dataTransfer && e.dataTransfer.types.indexOf(\"Files\") > -1) {\r\n                eventer.stop(e);\r\n            }\r\n        });\r\n\r\n        eventer.on(elm, \"dragleave\", function(e) {\r\n            if (e.dataTransfer && e.dataTransfer.types.indexOf(\"Files\") > -1) {\r\n                enterdCount--\r\n                if (enterdCount == 0) {\r\n                    styler.removeClass(elm, hoverClass);\r\n                }\r\n            }\r\n        });\r\n\r\n        eventer.on(elm, \"drop\", function(e) {\r\n            if (e.dataTransfer && e.dataTransfer.types.indexOf(\"Files\") > -1) {\r\n                styler.removeClass(elm, hoverClass)\r\n                eventer.stop(e);\r\n                if (droppedCallback) {\r\n                    var items = e.dataTransfer.items;\r\n                    if (items && items.length && (items[0].webkitGetAsEntry ||\r\n                            items[0].getAsEntry)) {\r\n                        webentry.all(\r\n                            langx.map(items, function(item) {\r\n                                if (item.webkitGetAsEntry) {\r\n                                    return item.webkitGetAsEntry();\r\n                                }\r\n                                return item.getAsEntry();\r\n                            })\r\n                        ).then(droppedCallback);\r\n                    } else {\r\n                        droppedCallback(e.dataTransfer.files);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n     return filer.dropzone = dropzone;\r\n});"]}